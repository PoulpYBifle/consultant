# =============================================================================
# STACK B2B CONSULTANT - CONFIGURATION CENTRALE
# =============================================================================
# Ce fichier est la source unique de v√©rit√© pour toutes les configurations.
# Tous les agents et skills DOIVENT charger ce fichier AVANT toute action.
# =============================================================================

# -----------------------------------------------------------------------------
# IDENTIT√â DU CONSULTANT
# -----------------------------------------------------------------------------
consultant:
  name: "CLAUDEGOAT"
  company: "Digital Transformation Consulting"
  email: ""
  specialty: "B2B SaaS / ERP / Process Digitalization"

# -----------------------------------------------------------------------------
# LANGUES
# -----------------------------------------------------------------------------
communication_language: "french"        # Langue de conversation avec l'utilisateur
document_output_language: "french"      # Langue des documents g√©n√©r√©s

# -----------------------------------------------------------------------------
# CHEMINS (relatifs √† la racine du projet)
# -----------------------------------------------------------------------------
paths:
  root: "{project-root}"
  consultant_home: "{project-root}/_consultant"
  project_context: "{project-root}/_consultant/project-context.md"
  workflow_status: "{project-root}/_consultant/workflow-status.yaml"
  project_path: "{project-root}/_consultant/project-path.yaml"
  sprint_status: "{project-root}/_consultant/sprint-status.yaml"
  stories_dir: "{project-root}/_consultant/stories"
  output_dir: "{project-root}/_consultant/output"
  templates_dir: "{project-root}/_consultant/templates"
  agents_dir: "{project-root}/_consultant/agents"
  skills_dir: "{project-root}/_consultant/skills"
  # Nouveaux chemins pour le syst√®me am√©lior√©
  sub_agents_dir: "{project-root}/_consultant/sub-agents"
  quality_gates_dir: "{project-root}/_consultant/quality-gates"

# -----------------------------------------------------------------------------
# SOUS-AGENTS PAR AGENT PRINCIPAL
# -----------------------------------------------------------------------------
sub_agents:
  discovery:
    - interviewer     # Questions profondes, 5 Whys
    - clarifier       # Transformer le flou en concret
    - framer          # Jobs-to-be-Done, scope
  architect:
    - tech-decider    # ADR format, d√©cisions techniques
    - spec-writer     # Specs sans ambigu√Øt√©
    - reviewer        # Review adversarial (3-10 issues)
  planner:
    - estimator       # Breakdown, complexity analysis
    - story-maker     # AC testables, Given/When/Then
    - sprint-org      # Dependencies, critical path
  developer:
    - coder           # ZERO PLACEHOLDERS
    - tester          # 100% AC coverage
    - code-reviewer   # Review adversarial (3-10 issues)
  delivery:
    - doc-writer      # User-focused docs
    - packager        # Checklist-driven delivery
    - validator       # Validation finale

# -----------------------------------------------------------------------------
# QUALITY GATES PAR PHASE
# -----------------------------------------------------------------------------
quality_gates:
  discovery: "discovery-gate.md"    # Avant passage √† Quotation
  specs: "specs-gate.md"            # Avant passage √† Planning
  planning: "planning-gate.md"      # Avant passage √† Development
  development: "development-gate.md" # Par story, STRICT (zero placeholders)
  delivery: "delivery-gate.md"      # Avant livraison finale

# -----------------------------------------------------------------------------
# NIVEAUX D'AUTONOMIE PAR AGENT
# -----------------------------------------------------------------------------
# very_high: Agent proc√®de sans confirmation
# high: Agent proc√®de, confirme aux checkpoints
# medium: Agent propose, attend approbation
# -----------------------------------------------------------------------------
autonomy:
  discovery: "high"
  architect: "high"
  planner: "high"
  developer: "very_high"
  delivery: "high"

# -----------------------------------------------------------------------------
# CHECKPOINTS CRITIQUES (toujours validation humaine)
# -----------------------------------------------------------------------------
critical_checkpoints:
  - quotation_approval      # Approbation du devis
  - final_delivery          # Livraison finale au client
  - scope_change            # Changement de p√©rim√®tre
  - security_decision       # D√©cision de s√©curit√©
  - budget_adjustment       # Ajustement budg√©taire

# -----------------------------------------------------------------------------
# TARIFICATION (pour les estimations)
# -----------------------------------------------------------------------------
rates:
  discovery_hourly: 150       # Tarif horaire discovery
  development_hourly: 120     # Tarif horaire d√©veloppement
  documentation_hourly: 100   # Tarif horaire documentation
  currency: "EUR"

# -----------------------------------------------------------------------------
# PR√âF√âRENCES DE PROJET
# -----------------------------------------------------------------------------
preferences:
  user_skill_level: "intermediate"  # beginner | intermediate | advanced
  default_priority: "P2"            # P1 | P2 | P3
  story_prefix: "STORY"             # Pr√©fixe des IDs de story

# -----------------------------------------------------------------------------
# R√àGLES GLOBALES
# -----------------------------------------------------------------------------
global_rules:
  - "ALWAYS load project-context.md before any action"
  - "ALWAYS update project-context.md after significant changes"
  - "NEVER skip checkpoints for critical actions"
  - "ALWAYS communicate in {communication_language}"
  - "ALWAYS generate documents in {document_output_language}"
  - "ALWAYS verify quality gate before phase transition"
  - "ALWAYS delegate to appropriate sub-agent for specialized tasks"

# -----------------------------------------------------------------------------
# üö® R√àGLES ANTI-PLACEHOLDER (CRITIQUES)
# -----------------------------------------------------------------------------
anti_placeholder_rules:
  enabled: true
  blocking: true  # Emp√™che de marquer une story "done" si placeholders trouv√©s

  # Patterns interdits
  forbidden_patterns:
    - "TODO"
    - "FIXME"
    - "@todo"
    - "Not implemented"
    - "not yet implemented"
    - "implement later"
    - "will be done"
    - "throw new Error"
    - "() => {}"
    - "function() {}"
    - "// temporary"
    - "// placeholder"
    - "// mock"

  # Actions si placeholder d√©tect√©
  on_placeholder_found:
    - "STOP - Do not mark story as done"
    - "RETURN to Coder sub-agent"
    - "IMPLEMENT actual functionality"
    - "RE-SCAN before proceeding"

  # Message d'erreur
  error_message: |
    üö® PLACEHOLDER D√âTECT√â - STORY NON TERMIN√âE

    Des placeholders ont √©t√© trouv√©s dans le code.
    Une story ne peut JAMAIS √™tre marqu√©e "done" avec des placeholders.

    Actions requises:
    1. Localiser les placeholders
    2. Impl√©menter le code r√©el
    3. Re-scanner
    4. Soumettre √† nouveau

# -----------------------------------------------------------------------------
# R√àGLES DE REVIEW ADVERSARIAL
# -----------------------------------------------------------------------------
adversarial_review_rules:
  minimum_issues: 3           # Minimum d'issues √† trouver par review
  maximum_issues: 10          # Pour √©viter le blocage excessif
  looks_good_forbidden: true  # "Looks good" n'est JAMAIS acceptable

  # Si moins de 3 issues trouv√©s
  insufficient_review_message: |
    ‚ö†Ô∏è REVIEW INCOMPL√àTE

    Seulement {found} issue(s) trouv√©(s). Minimum requis: 3.
    "Looks good" n'est JAMAIS acceptable.

    Veuillez approfondir la review:
    - V√©rifier la couverture des tests
    - Chercher les edge cases non g√©r√©s
    - Analyser la s√©curit√©
    - V√©rifier les patterns du projet
