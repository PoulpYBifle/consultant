# =============================================================================
# WORKFLOW STATUS - État d'avancement du projet
# =============================================================================
# Ce fichier est mis à jour automatiquement par l'orchestrateur après chaque skill.
# Il permet de savoir exactement où en est le projet et quelle est la prochaine action.
# =============================================================================

# -----------------------------------------------------------------------------
# PROJET
# -----------------------------------------------------------------------------
project:
  name: ""                        # Nom du projet (rempli par /init)
  client: ""                      # Nom du client
  type: ""                        # greenfield | brownfield
  phase: "not_started"            # not_started | discovery | quotation | specs | planning | development | delivery
  created: ""                     # Date de création (YYYY-MM-DD)
  last_activity: ""               # Dernière activité (YYYY-MM-DD HH:MM)

# -----------------------------------------------------------------------------
# STATUT DES WORKFLOWS
# -----------------------------------------------------------------------------
# Statuts possibles: pending | in_progress | completed | skipped
# -----------------------------------------------------------------------------
workflow_status:
  # Phase 0 - Analysis (Brownfield only)
  analyze-codebase: "pending"     # Analyse du code existant (brownfield uniquement)

  # Phase 1 - Discovery
  frame: "pending"                # Cadrage rapide du projet
  clarify: "pending"              # Clarification des besoins
  upsell: "pending"               # Identification opportunités (optionnel)

  # Phase 2 - Quotation
  estimate: "pending"             # Estimation de l'effort
  quote: "pending"                # Génération du devis formel

  # Phase 3 - Specs
  spec: "pending"                 # Spécification technique

  # Phase 4 - Planning
  create-story: "pending"         # Création des stories (repeatable)
  plan-sprint: "pending"          # Planification du sprint

  # Phase 5 - Development
  implement: "pending"            # Implémentation (repeatable)
  test: "pending"                 # Tests (repeatable)

  # Phase 6 - Delivery
  docs: "pending"                 # Documentation utilisateur
  handoff: "pending"              # Package de livraison

# -----------------------------------------------------------------------------
# PROCHAINE ACTION RECOMMANDÉE
# -----------------------------------------------------------------------------
next_action:
  workflow: "init"                # Workflow à exécuter
  agent: "orchestrator"           # Agent responsable
  reason: "Projet non initialisé" # Pourquoi cette action

# -----------------------------------------------------------------------------
# CHECKPOINTS PASSÉS
# -----------------------------------------------------------------------------
checkpoints_passed:
  # quotation_approval: ""        # Date d'approbation du devis
  # architecture_sign_off: ""     # Date de validation de l'architecture
  # final_delivery: ""            # Date de livraison finale

# -----------------------------------------------------------------------------
# QUALITY GATES STATUS
# -----------------------------------------------------------------------------
# Each phase has a quality gate that MUST pass before moving to next phase.
# Gate cannot be bypassed - all required items must be ✅
# -----------------------------------------------------------------------------
quality_gates:
  discovery:
    status: "pending"              # pending | in_progress | passed | blocked
    last_check: ""
    required_items: 11
    passed_items: 0
    blocking_items: []             # List of items blocking the gate

  specs:
    status: "pending"
    last_check: ""
    required_items: 12
    passed_items: 0
    review_issues_found: 0         # Adversarial review must find 3+ issues
    review_issues_resolved: 0
    blocking_items: []

  planning:
    status: "pending"
    last_check: ""
    required_items: 12
    passed_items: 0
    stories_validated: 0
    stories_incomplete: []
    buffer_percentage: 0           # Must be >= 20%
    blocking_items: []

  development:                     # Per-story gate tracked separately
    current_story: ""
    status: "pending"
    placeholder_scan: "pending"    # pending | passed | FAILED (blocking)
    tests_exist: "pending"         # pending | passed | FAILED (blocking)
    tests_pass: "pending"          # pending | passed | FAILED (blocking)
    review_done: "pending"         # pending | passed
    review_issues_found: 0         # Must find 3+ issues
    blockers_resolved: "pending"   # pending | passed | FAILED (blocking)
    blocking_items: []

  delivery:
    status: "pending"
    last_check: ""
    required_items: 17
    passed_items: 0
    docs_validated: false
    package_complete: false
    final_validation: "pending"    # pending | passed | FAILED
    blocking_items: []

# -----------------------------------------------------------------------------
# QUALITY GATE HISTORY
# -----------------------------------------------------------------------------
gate_history: []
  # - gate: "discovery"
  #   checked: "2024-01-15 14:30"
  #   result: "passed"
  #   items_checked: 11
  #   items_passed: 11
  # - gate: "development"
  #   story: "STORY-001"
  #   checked: "2024-01-16 10:00"
  #   result: "blocked"
  #   reason: "placeholder_scan_failed"
  #   placeholders_found: ["src/auth.ts:42", "src/user.ts:18"]

# -----------------------------------------------------------------------------
# NOTES & BLOCKERS
# -----------------------------------------------------------------------------
blockers: []                      # Liste des éléments bloquants
notes: []                         # Notes diverses

# -----------------------------------------------------------------------------
# HISTORIQUE (dernières 5 actions)
# -----------------------------------------------------------------------------
history: []
  # - workflow: "frame"
  #   completed: "2024-01-15 14:30"
  #   agent: "discovery"
  #   output: "output/discovery/frame.md"
